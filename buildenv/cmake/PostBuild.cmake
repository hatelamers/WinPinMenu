if(NOT ${BUILD_TYPE} MATCHES Debug)
    include("${SOURCE_DIR}/Product.cmake")
    file(READ "${SOURCE_DIR}/buildnumber.txt" BUILD_NUMBER)
	if(NOT ${BUILD_NUMBER})
		set(BUILD_NUMBER 1)
	endif()
    
	math(EXPR BUILD_NUMBER "${BUILD_NUMBER} + 1")
	if(${CMAKE_VERSION} VERSION_LESS 3.18)
		file(WRITE "${SOURCE_DIR}/buildnumber.txt" "${BUILD_NUMBER}")
	else()
		file(CONFIGURE OUTPUT "${SOURCE_DIR}/buildnumber.txt" CONTENT "${BUILD_NUMBER}")
	endif()
    file(REMOVE "${MAIN_TARGET_SOURCE_DIR}/productmeta.h")
    configure_file("${MAIN_TARGET_SOURCE_DIR}/productmeta.h.in" "${MAIN_TARGET_SOURCE_DIR}/productmeta.h")
    file(TOUCH_NOCREATE "${MAIN_TARGET_SOURCE_DIR}/${MAIN_TARGET_NAME}.rc")
    
	message(STATUS "Build number set to ${BUILD_NUMBER} in ${SOURCE_DIR}/buildnumber.txt")
endif()
